import{r as e,c as a,o as l,E as o,e as r,f as d,i as s,av as u,as as n,aD as t,aw as c,aV as p,ax as i,F as m,aH as f,aG as w,ar as b,aY as v,b5 as g,aI as V,bF as _}from"./.pnpm-B5NcQQUZ.js";import{q as h,_ as P,a as y}from"./index-DZ8Xxrs2.js";import{u as x}from"./useForm-BAG80Yrx.js";import{C as k}from"./card-form-C4fBbpZW.js";const C={class:"forget"},q={class:"forget-header"},U={class:"card-wrapper flex"},I={class:"send-code"},j=P({__name:"index",setup(P){const{formData:j,formRef:$,formConfig:F}=x({account:"",phone:"",code:"",newPwd:"",confirmPwd:""},{labelWidth:100}),{disabled:D,buttonText:E,sendCode:R}=function(){const r=e(0);let d=null;const s=a((()=>r.value>0)),u=a((()=>{const e=r.value;return e>0?`${e}s后重新发送`:"发送验证码"}));return l((()=>d&&clearInterval(d))),{countdown:r,disabled:s,buttonText:u,sendCode:function(e){if(!h(e))return o.warning("手机号格式不正确");r.value>0||(r.value=60,d=setInterval((()=>{r.value--,r.value<=0&&clearInterval(d)}),1e3))}}}(),T=e(!1),B={account:[{required:!0,message:"请输入账号",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"}],newPwd:[{required:!0,message:"请输入新密码",trigger:"blur"}],confirmPwd:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(e,a,l)=>{a!==j.value.newPwd?l(new Error("两次输入的密码不一致")):l()}}]};async function G(){await $.value.validate(),T.value=!0}return(e,a)=>{const l=i,o=v,h=g,P=V,x=_;return r(),d("div",C,[s("div",q,[u(l,{onBack:a[0]||(a[0]=a=>e.$router.go(-1))},{content:n((()=>a[9]||(a[9]=[s("h4",null,"忘记密码",-1)]))),_:1})]),s("div",U,[u(c(k),t({ref_key:"formRef",ref:$,modelValue:c(j),"onUpdate:modelValue":a[8]||(a[8]=e=>p(j)?j.value=e:null),rules:B,class:"card-form"},c(F)),{default:n((()=>[c(T)?(r(),b(x,{key:1,icon:"success",title:"密码重置成功","sub-title":"可以使用新密码登录了"},{extra:n((()=>[u(P,{type:"primary",onClick:a[7]||(a[7]=a=>e.$router.replace(`/${c(y)}`))},{default:n((()=>a[11]||(a[11]=[f("返回登录")]))),_:1})])),_:1})):(r(),d(m,{key:0},[u(h,{label:"账号",prop:"account"},{default:n((()=>[u(o,{modelValue:c(j).account,"onUpdate:modelValue":a[1]||(a[1]=e=>c(j).account=e),placeholder:"注册时填写的登录账号"},null,8,["modelValue"])])),_:1}),u(h,{label:"手机号",prop:"phone"},{default:n((()=>[u(o,{modelValue:c(j).phone,"onUpdate:modelValue":a[2]||(a[2]=e=>c(j).phone=e),placeholder:"注册时填写的手机号"},null,8,["modelValue"])])),_:1}),u(h,{label:"验证码",prop:"code"},{default:n((()=>[s("div",I,[u(o,{modelValue:c(j).code,"onUpdate:modelValue":a[3]||(a[3]=e=>c(j).code=e),placeholder:"手机验证码"},null,8,["modelValue"]),u(P,{disabled:c(D),onClick:a[4]||(a[4]=e=>c(R)(c(j).phone))},{default:n((()=>[f(w(c(E)),1)])),_:1},8,["disabled"])])])),_:1}),u(h,{label:"新密码",prop:"newPwd"},{default:n((()=>[u(o,{modelValue:c(j).newPwd,"onUpdate:modelValue":a[5]||(a[5]=e=>c(j).newPwd=e),"show-password":"",placeholder:"填写新的登录密码",type:"password"},null,8,["modelValue"])])),_:1}),u(h,{label:"确认新密码",prop:"confirmPwd"},{default:n((()=>[u(o,{modelValue:c(j).confirmPwd,"onUpdate:modelValue":a[6]||(a[6]=e=>c(j).confirmPwd=e),"show-password":"",placeholder:"再次确认新密码",type:"password"},null,8,["modelValue"])])),_:1}),u(h,null,{default:n((()=>[u(P,{type:"primary",onClick:G},{default:n((()=>a[10]||(a[10]=[f("提交")]))),_:1})])),_:1})],64))])),_:1},16,["modelValue"])])])}}},[["__scopeId","data-v-d4e67db8"]]);export{j as default};
