import{ar as e,bG as a,as as t,aU as l,c0 as i,c1 as n,ab as s,h as o,aI as u,ac as d,an as r,ah as p,ae as c,ao as f,aP as m,ax as y,aj as g,at as v,ai as S,aO as b,aN as x,af as h,ag as w,E as _,bP as z,c2 as I}from"./.pnpm-BLGzruUg.js";import{N,d as C,_ as B,e as j}from"./index-CjL9fGc7.js";function k(e){return N.post("/upload/image",e)}const F={disabled:{type:Boolean,default:!1},autoUpload:{type:Boolean,default:!1},action:{type:String,default:""},name:{type:String,default:"name"},data:{type:[Object,Function],default:()=>{}},showFileList:{type:Boolean,default:!0},limit:{type:Number,default:3},multiple:{type:Boolean,default:!0},borderRadius:{type:String,default:"4px"},title:{type:String,default:""},iconName:{type:String,default:"Plus"},iconType:{type:String,default:C.EL_ICON,validator:e=>[C.EL_ICON,C.SVG].includes(e)},iconSize:{type:[Number,String],default:18},height:{type:String,default:"148px"},width:{type:String,default:"148px"},customStyle:{type:Object,default:()=>{}}},O={...F,tip:{type:String,default:""},maxSize:{type:Number,default:10},round:{type:Boolean,default:!1},drag:{type:Boolean,default:!1},api:Function,previewText:{type:String,default:"查看"},previewIcon:{type:String,default:"View"},deleteText:{type:String,default:"删除"},deleteIcon:{type:String,default:"Delete"}},T={...F,tag:{type:String,default:"button",validator:e=>["button","card"].includes(e)},accept:{type:String,default:""}},V={class:"upload-box"},E={class:"upload-empty"},L=["src"],U=["onClick"],$=["onClick"],M={class:"el-upload__tip"},P=B({__name:"index",props:e(O,{modelValue:{type:Array,default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(e){a((e=>({"9bc0ef02":g(T),"767a29f2":C.width,"8c6907f4":C.height})));const N=t(e,"modelValue"),C=e,B=l(i,void 0),F=l(n,void 0),O=s((()=>C.disabled||(null==B?void 0:B.disabled))),T=s((()=>{const e=C;return e.round?"50%":e.borderRadius})),P=o([]),D=o(""),G=o(!1);function R(e){const a=C,t=e.size/1024/1024<a.maxSize,l=a.accept.includes(e.type);return l?t?t&&l:_.warning(`图片大小不能超过${a.maxSize}MB`):_.warning("请选择正确的图片格式")}async function q(e){const a=new FormData,t=e.data||{};a.append(e.filename,e.file);for(const i in t)a.append(i,t[i]);try{const t=(null==C?void 0:C.api)||k,l=await t(a);e.onSuccess(l)}catch(l){e.onError(l)}}function A(e,a){e&&(a.url=e.url,N.value=P.value,(null==F?void 0:F.prop)&&(null==B||B.validateField([F.prop])),_.success("上传成功"))}function H(e,a){_.error("上传失败")}function J(){_.warning(`最多只能上传${C.limit}张图片`)}return u((()=>N.value),(e=>P.value=e)),(e,a)=>{const t=j,l=z,i=I;return d(),r("div",V,[p(l,{"file-list":g(P),"onUpdate:fileList":a[1]||(a[1]=e=>b(P)?P.value=e:null),action:"#",accept:"image/gif, image/jpeg, image/png","list-type":"picture-card",class:x(["upload",g(O)?"disabled":"",e.drag?"no-border":""]),multiple:!0,disabled:g(O),limit:e.limit,"http-request":q,"before-upload":R,"on-exceed":J,"on-success":A,"on-error":H,drag:e.drag},{file:c((({file:l})=>[f("img",{src:l.url,class:"upload-image"},null,8,L),f("div",{class:"upload-handle",onClick:a[0]||(a[0]=m((()=>{}),["stop"]))},[f("div",{class:"handle-icon",onClick:e=>function(e){D.value=e.url,G.value=!0}(l)},[p(t,{name:e.previewIcon},null,8,["name"]),f("span",null,y(e.previewText),1)],8,U),g(O)?v("",!0):(d(),r("div",{key:0,class:"handle-icon",onClick:e=>function(e){const a=P.value.filter((a=>a.url!==e.url||a.name!==e.name));P.value=a,N.value=a}(l)},[p(t,{name:e.deleteIcon},null,8,["name"]),f("span",null,y(e.deleteIcon),1)],8,$))])])),default:c((()=>[f("div",E,[S(e.$slots,"empty",{},(()=>[p(t,{name:e.iconName,type:e.iconType,size:e.iconSize},null,8,["name","type","size"]),f("p",null,y(e.title),1)]),!0)])])),_:3},8,["file-list","class","disabled","limit","drag"]),f("div",M,[S(e.$slots,"tip",{},(()=>[f("span",null,"大小不超过"+y(e.maxSize)+"M",1)]),!0)]),h(p(i,{"url-list":[g(D)],onClose:a[2]||(a[2]=e=>G.value=!1)},null,8,["url-list"]),[[w,g(G)]])])}}},[["__scopeId","data-v-ba145fa9"]]);export{P as U,T as u};
