import{cn as e}from"./.pnpm-BLGzruUg.js";import{w as t,u as r,S as n}from"./xlsx-BW9CG9W1.js";function o(e,t){for(var o,s={},a={s:{c:1e7,r:1e7},e:{c:0,r:0}},l=0;l!=e.length;++l)for(var c=0;c!=e[l].length;++c){a.s.r>l&&(a.s.r=l),a.s.c>c&&(a.s.c=c),a.e.r<l&&(a.e.r=l),a.e.c<c&&(a.e.c=c);var h={v:e[l][c]};if(null!=h.v){var i=r.encode_cell({c:c,r:l});"number"==typeof h.v?h.t="n":"boolean"==typeof h.v?h.t="b":h.v instanceof Date?(h.t="n",h.z=n._table[14],h.v=(o=h.v,(Date.parse(o)-new Date(Date.UTC(1899,11,30)))/864e5)):h.t="s",s[i]=h}}return a.s.c<1e7&&(s["!ref"]=r.encode_range(a)),s}function s(){if(!(this instanceof s))return new s;this.SheetNames=[],this.Sheets={}}function a(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=255&e.charCodeAt(n);return t}function l(r){var n=function(e){for(var t=[],r=e.querySelectorAll("tr"),n=[],o=0;o<r.length;++o){for(var s=[],a=r[o].querySelectorAll("td"),l=0;l<a.length;++l){var c=a[l],h=c.getAttribute("colspan"),i=c.getAttribute("rowspan"),f=c.innerText;if(""!==f&&f==+f&&(f=+f),n.forEach((function(e){if(o>=e.s.r&&o<=e.e.r&&s.length>=e.s.c&&s.length<=e.e.c)for(var t=0;t<=e.e.c-e.s.c;++t)s.push(null)})),(i||h)&&(i=i||1,h=h||1,n.push({s:{r:o,c:s.length},e:{r:o+i-1,c:s.length+h-1}})),s.push(""!==f?f:null),h)for(var u=0;u<h-1;++u)s.push(null)}t.push(s)}return[t,n]}(document.getElementById(r)),l=n[1],c=n[0],h="SheetJS",i=new s,f=o(c);f["!merges"]=l,i.SheetNames.push(h),i.Sheets[h]=f;var u=t(i,{bookType:"xlsx",bookSST:!1,type:"binary"});e.saveAs(new Blob([a(u)],{type:"application/octet-stream"}),"test.xlsx")}function c({multiHeader:n=[],header:l,data:c,filename:h,merges:i=[],autoWidth:f=!0,bookType:u="xlsx"}={}){h=h||"excel-list",(c=[...c]).unshift(l);for(let e=n.length-1;e>-1;e--)c.unshift(n[e]);var p="SheetJS",g=new s,v=o(c);if(i.length>0&&(v["!merges"]||(v["!merges"]=[]),i.forEach((e=>{v["!merges"].push(r.decode_range(e))}))),f){const e=c.map((e=>e.map((e=>null==e?{wch:10}:e.toString().charCodeAt(0)>255?{wch:2*e.toString().length}:{wch:e.toString().length}))));let t=e[0];for(let r=1;r<e.length;r++)for(let n=0;n<e[r].length;n++)t[n].wch<e[r][n].wch&&(t[n].wch=e[r][n].wch);v["!cols"]=t}g.SheetNames.push(p),g.Sheets[p]=v;var m=t(g,{bookType:u,bookSST:!1,type:"binary"});e.saveAs(new Blob([a(m)],{type:"application/octet-stream"}),`${h}.${u}`)}export{c as export_json_to_excel,l as export_table_to_excel};
