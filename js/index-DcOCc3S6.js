import{_ as e,z as a,A as l,d as t,e as o,x as r}from"./index-CMBT9BYn.js";import{bz as c,r as s,aA as n,bA as i,az as p,a3 as u,ae as d,af as m,ao as f,a4 as v,a5 as b,a8 as g,aa as _,al as R,ap as C,be as y,aS as h,aT as k,aX as w,aY as j,aV as V,aW as z,a_ as x,by as B,aq as O,aE as U,aF as D}from"./.pnpm-DSXWUmMM.js";import{u as F}from"./useForm-D-WJXbO_.js";const L={zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,autoCrop:!0,background:!0,highlight:!0,center:!0,responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,scalable:!0,modal:!0,guides:!0,movable:!0,rotatable:!0},S={src:{type:String,default:""},compress:{type:Number,default:1},viewMode:{type:Number,default:2},aspectRatio:{type:Number,default:1},circle:{type:Boolean,default:!1},title:{type:String,default:"图片预览"}},E={class:"cropper"},M={class:"cropper-img"},N=["src"],A={class:"cropper-preview"},Y=e({__name:"index",props:S,setup(e,{expose:t}){c((e=>({"144ef628":o.circle?"50%":0})));const o=e,r=s(null),v=s(null),b=s(null);let g=1,_=1;return n((()=>{const e=o;v.value=new i(b.value,{...L,viewMode:e.viewMode,aspectRatio:e.aspectRatio,preview:r.value})})),p((()=>o.aspectRatio),(e=>{return a=e,void v.value.setAspectRatio(a);var a})),t({cropperRef:v,getCropData:function(e,l="image/jpeg"){if(!a(e))throw new Error("first parameter: callback must be a function");e(v.value.getCroppedCanvas().toDataURL(l,o.compress))},getCropBlob:function(e,l="image/jpeg"){if(!a(e))throw new Error("first parameter: callback must be a function");v.value.getCroppedCanvas().toBlob((a=>e(a)),l,o.compress)},getCropFile:function(e,l="fileName.jpg",t="image/jpeg"){if(!a(e))throw new Error("first parameter: callback must be a function");v.value.getCroppedCanvas().toBlob((a=>{let o=new File([a],l,{type:t});e(o)}),t,o.compress)},handleCropper:function(e,a){var t,o,r,c;"scaleX"===e&&(g=a=-1===g?1:-1),"scaleY"===e&&(_=a=-1===_?1:-1),a&&l(a)?null==(o=null==(t=v.value)?void 0:t[e])||o.call(t,...a):null==(c=null==(r=v.value)?void 0:r[e])||c.call(r,a)}}),(e,a)=>(u(),d("div",E,[m("div",M,[m("img",{ref_key:"imgRef",ref:b,src:e.src},null,8,N)]),m("div",A,[m("h4",null,f(e.title),1),m("div",{ref_key:"previewRef",ref:r,class:"cropper-preview-img"},null,512)])]))}},[["__scopeId","data-v-ecdb5158"]]),G=(e=>(U("data-v-1babf2c5"),e=e(),D(),e))((()=>m("h3",null,"配置参数",-1))),I=["src"],W=e({__name:"index",setup(e){const{formData:a,formConfig:l}=F({compress:1,aspectRatio:0,circle:!1},{labelWidth:"120"}),c=s(null),n=s("");function i(e,a){c.value.cropperRef[e](a)}async function p(){c.value.getCropData((e=>{n.value=e}))}function d(){c.value.getCropBlob((e=>{n.value=URL.createObjectURL(e)}))}function f(){c.value.getCropFile((e=>{const a=document.createElement("a");a.download=e.name,a.href=URL.createObjectURL(e),a.click()}),"fileName.jpg","image/jpeg")}return(e,s)=>{const U=o,D=y,F=h,L=k,S=w,E=j,M=V,N=z,A=x,W=B,X=O,T=r;return u(),v(T,null,{default:b((()=>[g(W,{shadow:"never"},{default:b((()=>[g(_(Y),{ref_key:"cropperRef",ref:c,src:"https://fuss10.elemecdn.com/a/3f/3302e58f9a181d2509f3dc0fa68b0jpeg.jpeg",compress:_(a).compress,aspectRatio:_(a).aspectRatio,circle:_(a).circle},null,8,["compress","aspectRatio","circle"]),g(F,{size:16,wrap:"",style:{"margin-top":"24px"}},{default:b((()=>[g(D,{content:"圆形、矩形裁剪"},{default:b((()=>[g(U,{type:_(t).SVG,name:"circle-rect",onClick:s[0]||(s[0]=e=>_(a).circle=!_(a).circle)},null,8,["type"])])),_:1}),g(D,{content:"顺时针旋转45度"},{default:b((()=>[g(U,{name:"RefreshRight",onClick:s[1]||(s[1]=e=>i("rotate",45))})])),_:1}),g(D,{content:"逆时针旋转45度"},{default:b((()=>[g(U,{name:"RefreshLeft",onClick:s[2]||(s[2]=e=>i("rotate",-45))})])),_:1}),g(D,{content:"水平翻转"},{default:b((()=>[g(U,{type:_(t).SVG,name:"vertical",onClick:s[3]||(s[3]=e=>i("scaleX",-1))},null,8,["type"])])),_:1}),g(D,{content:"垂直翻转"},{default:b((()=>[g(U,{type:_(t).SVG,name:"horizontal",onClick:s[4]||(s[4]=e=>i("scaleY",-1))},null,8,["type"])])),_:1}),g(D,{content:"放大"},{default:b((()=>[g(U,{name:"ZoomOut",onClick:s[5]||(s[5]=e=>i("zoom",.1))})])),_:1}),g(D,{content:"缩小"},{default:b((()=>[g(U,{name:"ZoomIn",onClick:s[6]||(s[6]=e=>i("zoom",-.1))})])),_:1}),g(D,{content:"重置"},{default:b((()=>[g(U,{name:"Refresh",onClick:s[7]||(s[7]=e=>i("reset"))})])),_:1})])),_:1}),g(L),G,g(A,R({model:_(a)},_(l)),{default:b((()=>[g(M,{label:"aspectRatio"},{label:b((()=>[g(D,{content:"固定选区或者不固定"},{default:b((()=>[C(" aspectRatio ")])),_:1})])),default:b((()=>[g(E,{modelValue:_(a).aspectRatio,"onUpdate:modelValue":s[8]||(s[8]=e=>_(a).aspectRatio=e)},{default:b((()=>[g(S,{label:"自由",value:0}),g(S,{label:"1:1",value:1}),g(S,{label:"4:3",value:4/3}),g(S,{label:"16:9",value:16/9})])),_:1},8,["modelValue"])])),_:1}),g(M,{label:"compress"},{label:b((()=>[g(D,{content:"图像压缩率，可选值为：0.1-1"},{default:b((()=>[C(" compress ")])),_:1})])),default:b((()=>[g(E,{modelValue:_(a).compress,"onUpdate:modelValue":s[9]||(s[9]=e=>_(a).compress=e)},{default:b((()=>[g(S,{label:"0.1",value:.1}),g(S,{label:"0.5",value:.5}),g(S,{label:"1",value:1})])),_:1},8,["modelValue"])])),_:1}),g(M,{label:"circle"},{default:b((()=>[g(N,{modelValue:_(a).circle,"onUpdate:modelValue":s[10]||(s[10]=e=>_(a).circle=e)},null,8,["modelValue"])])),_:1})])),_:1},16,["model"]),g(L),g(W,{shadow:"never",header:"裁剪结果"},{default:b((()=>[m("img",{src:_(n)},null,8,I)])),_:1}),g(F,{size:26,wrap:"",style:{"margin-top":"var(--el-card-padding)"}},{default:b((()=>[g(X,{type:"primary",onClick:p},{default:b((()=>[C("Base64")])),_:1}),g(X,{type:"primary",onClick:d},{default:b((()=>[C("Blob")])),_:1}),g(X,{type:"primary",onClick:f},{default:b((()=>[C("File")])),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-1babf2c5"]]);export{W as default};
