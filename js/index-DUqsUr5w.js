import{_ as e,z as a,A as l,d as t,e as o,x as r}from"./index-DZ8Xxrs2.js";import{bL as c,r as s,aR as n,bO as i,a as p,e as u,f as d,i as m,aG as f,ar as b,as as v,av as g,aw as _,aD as R,aH as C,bq as y,b2 as h,b3 as k,b7 as w,b8 as j,b5 as V,b6 as z,ba as x,bJ as B,aI as O}from"./.pnpm-B5NcQQUZ.js";import{u as U}from"./useForm-BAG80Yrx.js";const D={zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,autoCrop:!0,background:!0,highlight:!0,center:!0,responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,scalable:!0,modal:!0,guides:!0,movable:!0,rotatable:!0},L={src:{type:String,default:""},compress:{type:Number,default:1},viewMode:{type:Number,default:2},aspectRatio:{type:Number,default:1},circle:{type:Boolean,default:!1},title:{type:String,default:"图片预览"}},F={class:"cropper"},M={class:"cropper-img"},N=["src"],S={class:"cropper-preview"},E=e({__name:"index",props:L,setup(e,{expose:t}){c((e=>({"144ef628":o.circle?"50%":0})));const o=e,r=s(null),b=s(null),v=s(null);let g=1,_=1;return n((()=>{const e=o;b.value=new i(v.value,{...D,viewMode:e.viewMode,aspectRatio:e.aspectRatio,preview:r.value})})),p((()=>o.aspectRatio),(e=>{return a=e,void b.value.setAspectRatio(a);var a})),t({cropperRef:b,getCropData:function(e,l="image/jpeg"){if(!a(e))throw new Error("first parameter: callback must be a function");e(b.value.getCroppedCanvas().toDataURL(l,o.compress))},getCropBlob:function(e,l="image/jpeg"){if(!a(e))throw new Error("first parameter: callback must be a function");b.value.getCroppedCanvas().toBlob((a=>e(a)),l,o.compress)},getCropFile:function(e,l="fileName.jpg",t="image/jpeg"){if(!a(e))throw new Error("first parameter: callback must be a function");b.value.getCroppedCanvas().toBlob((a=>{let o=new File([a],l,{type:t});e(o)}),t,o.compress)},handleCropper:function(e,a){var t,o,r,c;"scaleX"===e&&(g=a=-1===g?1:-1),"scaleY"===e&&(_=a=-1===_?1:-1),a&&l(a)?null==(o=null==(t=b.value)?void 0:t[e])||o.call(t,...a):null==(c=null==(r=b.value)?void 0:r[e])||c.call(r,a)}}),(e,a)=>(u(),d("div",F,[m("div",M,[m("img",{ref_key:"imgRef",ref:v,src:e.src},null,8,N)]),m("div",S,[m("h4",null,f(e.title),1),m("div",{ref_key:"previewRef",ref:r,class:"cropper-preview-img"},null,512)])]))}},[["__scopeId","data-v-ecdb5158"]]),G=["src"],I=e({__name:"index",setup(e){const{formData:a,formConfig:l}=U({compress:1,aspectRatio:0,circle:!1},{labelWidth:"120"}),c=s(null),n=s("");function i(e,a){c.value.cropperRef[e](a)}async function p(){c.value.getCropData((e=>{n.value=e}))}function d(){c.value.getCropBlob((e=>{n.value=URL.createObjectURL(e)}))}function f(){c.value.getCropFile((e=>{const a=document.createElement("a");a.download=e.name,a.href=URL.createObjectURL(e),a.click()}),"fileName.jpg","image/jpeg")}return(e,s)=>{const U=o,D=y,L=h,F=k,M=w,N=j,S=V,I=z,A=x,W=B,X=O,Y=r;return u(),b(Y,null,{default:v((()=>[g(W,{shadow:"never"},{default:v((()=>[g(_(E),{ref_key:"cropperRef",ref:c,src:"https://fuss10.elemecdn.com/a/3f/3302e58f9a181d2509f3dc0fa68b0jpeg.jpeg",compress:_(a).compress,aspectRatio:_(a).aspectRatio,circle:_(a).circle},null,8,["compress","aspectRatio","circle"]),g(L,{size:16,wrap:"",style:{"margin-top":"24px"}},{default:v((()=>[g(D,{content:"圆形、矩形裁剪"},{default:v((()=>[g(U,{type:_(t).SVG,name:"circle-rect",onClick:s[0]||(s[0]=e=>_(a).circle=!_(a).circle)},null,8,["type"])])),_:1}),g(D,{content:"顺时针旋转45度"},{default:v((()=>[g(U,{name:"RefreshRight",onClick:s[1]||(s[1]=e=>i("rotate",45))})])),_:1}),g(D,{content:"逆时针旋转45度"},{default:v((()=>[g(U,{name:"RefreshLeft",onClick:s[2]||(s[2]=e=>i("rotate",-45))})])),_:1}),g(D,{content:"水平翻转"},{default:v((()=>[g(U,{type:_(t).SVG,name:"vertical",onClick:s[3]||(s[3]=e=>i("scaleX",-1))},null,8,["type"])])),_:1}),g(D,{content:"垂直翻转"},{default:v((()=>[g(U,{type:_(t).SVG,name:"horizontal",onClick:s[4]||(s[4]=e=>i("scaleY",-1))},null,8,["type"])])),_:1}),g(D,{content:"放大"},{default:v((()=>[g(U,{name:"ZoomOut",onClick:s[5]||(s[5]=e=>i("zoom",.1))})])),_:1}),g(D,{content:"缩小"},{default:v((()=>[g(U,{name:"ZoomIn",onClick:s[6]||(s[6]=e=>i("zoom",-.1))})])),_:1}),g(D,{content:"重置"},{default:v((()=>[g(U,{name:"Refresh",onClick:s[7]||(s[7]=e=>i("reset"))})])),_:1})])),_:1}),g(F),s[16]||(s[16]=m("h3",null,"配置参数",-1)),g(A,R({model:_(a)},_(l)),{default:v((()=>[g(S,{label:"aspectRatio"},{label:v((()=>[g(D,{content:"固定选区或者不固定"},{default:v((()=>s[11]||(s[11]=[C(" aspectRatio ")]))),_:1})])),default:v((()=>[g(N,{modelValue:_(a).aspectRatio,"onUpdate:modelValue":s[8]||(s[8]=e=>_(a).aspectRatio=e)},{default:v((()=>[g(M,{label:"自由",value:0}),g(M,{label:"1:1",value:1}),g(M,{label:"4:3",value:4/3}),g(M,{label:"16:9",value:16/9})])),_:1},8,["modelValue"])])),_:1}),g(S,{label:"compress"},{label:v((()=>[g(D,{content:"图像压缩率，可选值为：0.1-1"},{default:v((()=>s[12]||(s[12]=[C(" compress ")]))),_:1})])),default:v((()=>[g(N,{modelValue:_(a).compress,"onUpdate:modelValue":s[9]||(s[9]=e=>_(a).compress=e)},{default:v((()=>[g(M,{label:"0.1",value:.1}),g(M,{label:"0.5",value:.5}),g(M,{label:"1",value:1})])),_:1},8,["modelValue"])])),_:1}),g(S,{label:"circle"},{default:v((()=>[g(I,{modelValue:_(a).circle,"onUpdate:modelValue":s[10]||(s[10]=e=>_(a).circle=e)},null,8,["modelValue"])])),_:1})])),_:1},16,["model"]),g(F),g(W,{shadow:"never",header:"裁剪结果"},{default:v((()=>[m("img",{src:_(n)},null,8,G)])),_:1}),g(L,{size:26,wrap:"",style:{"margin-top":"var(--el-card-padding)"}},{default:v((()=>[g(X,{type:"primary",onClick:p},{default:v((()=>s[13]||(s[13]=[C("Base64")]))),_:1}),g(X,{type:"primary",onClick:d},{default:v((()=>s[14]||(s[14]=[C("Blob")]))),_:1}),g(X,{type:"primary",onClick:f},{default:v((()=>s[15]||(s[15]=[C("File")]))),_:1})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-1babf2c5"]]);export{I as default};
